<%- include('includes/head'); %> <%- include('includes/nav'); %>

        <main style="margin-top: 6em">
            <div class="container pt-4">
                <div class="row">
                    <div class="col-lg-1"></div>
                    <div class="col-sm-12 col-md-12 col-lg-10">
                        <table id="example" class="table table-striped" style="width: 100%">
                            <thead>
                                <tr>
                                    <th>ID <i class="fas fa-up-down"></i></th>
                                    <th>Grupo <i class="fas fa-up-down"></i></th>
                                    <th>Setores <i class="fas fa-up-down"></i></th>
                                    <th>Ação <i class="fas fa-gear"></i></th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Dentro do loop forEach -->
                                <% grupos.forEach(grupos=> { %>
                                    <tr>
                                        <td>
                                            <%= grupos.id %>
                                        </td>
                                        <td>
                                            <%= grupos.nome %>
                                        </td>
                                        <td>
                                            <%= grupos.setores %>
                                        </td>
                                        <td>
                                            <button type="button" class="btn btn-primary btn-editar"
                                                data-id="<%= grupos.id %>" data-nome="<%= grupos.nome %>"
                                                data-setor="<%= grupos.setores %>">
                                                Editar
                                            </button>
                                        </td>
                                        <td>
                                            <button type="button" class="btn btn-primary">Remover</button>
                                        </td>
                                    </tr>
                                    <% }) %>
                            </tbody>
                        </table>
                    </div>
                    <div class="col-lg-1"></div>
                </div>
            </div>
        </main>

        <!-- Modal -->
        <div class="modal fade" id="modaleditgroup" tabindex="-1" aria-labelledby="modaleditgroupLabel" aria-hidden="true">
            <div class="modal-dialog">
                <form action="/editgrupos" method="POST">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="modaleditgroupLabel">
                                <strong>Editar Grupo</strong>
                            </h5>
                            <button type="button" class="btn-close" data-mdb-ripple-init data-mdb-dismiss="modal"
                                aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <!-- Email input -->
                            <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
                            <input type="hidden" name="_id" id="idmodel"  />
                            <div data-mdb-input-init class="form-outline mb-4">
                                <input type="text" id="namemodel" class="form-control active" name="nome" required />
                                <label class="form-label" for="form1Example1">Nome do Grupo</label>
                            </div>
                            <div data-mdb-input-init class="form-outline mb-4">
                                <label class="form-label" for="form1Example1">Escolha para onde o grupo pode abrir
                                    chamados</label>
                                <select class="form-select" aria-label=".form-select-sm example" multiple
                                    data-mdb-container="#exampleModal" data-mdb-filter="true" name="setores" required>
                                    <% setores.forEach(setores=> { %>
                                        <option value="<%= setores %>">
                                            <%= setores %>
                                        </option>
                                        <% }); %>
                                </select>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-mdb-ripple-init
                                data-mdb-dismiss="modal">
                                Close
                            </button>
                            <button type="submit" class="btn btn-primary" data-mdb-ripple-init>
                                Salvar Grupo
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <script type="module" nonce="<%= nonce %>" src="assets/js/jquery-3.0.1/jquery.js"></script>
        <script nonce="<%= nonce %>" src="assets/css/MDB5-7.1.0/js/mdb.umd.min.js"></script>
        <script type="module" nonce="<%= nonce %>" src="assets/js/edit.js"></script>